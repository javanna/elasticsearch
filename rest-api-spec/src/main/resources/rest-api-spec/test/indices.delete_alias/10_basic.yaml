---
"Basic test for delete alias":
  - skip:
      version: " - 5.4.99"
      reason: Previous versions did not 404 on missing aliases

  - do:
      indices.create:
        index: testind

  - do:
      indices.put_alias:
        index: testind
        name:  testali
        body:
          routing: "routing value"

  - do:
      indices.get_alias:
        name: testali

  - match: {testind.aliases.testali.search_routing: "routing value"}
  - match: {testind.aliases.testali.index_routing: "routing value"}

  - do:
      indices.delete_alias:
        index: testind
        name: testali

  - do:
      catch: missing
      indices.get_alias:
        index: testind
        name:  testali
  
  - match: { 'status': 404 }
  - match: { 'error': 'alias [testali] missing' }

---
"Specifying alias in the index side is deprecated":

  - skip:
      version: " - 5.5.99"
      reason: deprecation was added in 5.6.0
      features: "warnings"

  - do:
      indices.create:
        index: test_index
        body:
          aliases :
            test_alias: {}
            test_alias2: {}

  - do:
      indices.delete_alias:
        index: test_alias
        name: test_alias
      warnings:
        - "Support for providing / matching aliases as part of the index parameter in the delete index, update aliases, put alias, and delete alias APIs is deprecated. The following expressions match one or more aliases: [test_alias], the corresponding concrete indices should be provided instead."

  - do:
      indices.exists_alias:
        name: test_alias

  - is_false: ''

  - do:
      indices.delete_alias:
        index: test_a*
        name: test_alias2
      warnings:
        - "Support for providing / matching aliases as part of the index parameter in the delete index, update aliases, put alias, and delete alias APIs is deprecated. The following expressions match one or more aliases: [test_a*], the corresponding concrete indices should be provided instead."

  - do:
      indices.exists_alias:
        name: test_alias2

  - is_false: ''
